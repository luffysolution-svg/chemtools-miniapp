<view class="complexation-page">
  <view class="page-header">
    <text class="header-icon">🧷</text>
    <view class="header-content">
      <view class="header-title">络合/掩蔽估算</view>
      <view class="header-desc">条件稳定常数、络合分数计算</view>
    </view>
  </view>

  <view class="section-card">
    <view class="section-title">🔗 络合平衡计算</view>
    <view class="section-description">估算络合反应的条件稳定常数K'</view>
    
    <view class="form-section">
      <calculator-input label="稳定常数 logβ" type="digit" value="{{logBeta}}" placeholder="例如：18.8" hint="金属-配体络合的logβ值" bindinput="handleLogBetaInput" />
      <calculator-input label="配体总浓度 C_L (mol·L⁻¹)" type="digit" value="{{ligandConc}}" placeholder="例如：0.01" bindinput="handleLigandInput" />
      <calculator-input label="金属总浓度 C_M (mol·L⁻¹)" type="digit" value="{{metalConc}}" placeholder="例如：0.001" bindinput="handleMetalInput" />
      <calculator-input label="pH值" type="digit" value="{{pH}}" placeholder="例如：7" hint="溶液pH，影响配体电离" bindinput="handlePHInput" />
      
      <view class="action-buttons">
        <button class="btn-primary" bindtap="calculate">计算</button>
        <button class="btn-secondary" bindtap="reset">清空</button>
      </view>
    </view>
    
    <result-card wx:if="{{result}}" title="计算结果" result="{{resultText}}" hint="{{hint}}" show-copy="{{true}}" show-export="{{true}}" show-history="{{true}}" history-type="complexation" history-input="{{historyInput}}" unit="{{unit}}" precision="科学计数法" formula="{{formula}}" data-source="络合平衡理论" show-metadata="{{true}}" metadata-expanded="{{false}}">
      <view class="result-value">{{result}}</view>
    </result-card>
    
    <view class="info-card">
      <view class="info-header"><text class="info-icon">📖</text><text>计算说明</text></view>
      <view class="info-content">
        <view class="formula-item">
          <text class="formula-label">条件稳定常数：</text>
          <text class="formula">K' = β × α_M × α_L</text>
        </view>
        <view class="formula-item">
          <text class="formula-label">其中：</text>
          <text class="formula">β - 稳定常数</text>
          <text class="formula">α_M - 金属离子副反应系数</text>
          <text class="formula">α_L - 配体副反应系数</text>
        </view>
        <view class="formula-item">
          <text class="formula-label">络合分数：</text>
          <text class="formula">α = [ML] / C_M</text>
        </view>
      </view>
    </view>
  </view>

  <view class="tip-card">
    <view class="tip-header"><text class="tip-icon">💡</text><text>常见配体logβ示例</text></view>
    <view class="tip-content">
      <text>• EDTA-Cu²⁺：logβ ≈ 18.8</text>
      <text>• EDTA-Zn²⁺：logβ ≈ 16.5</text>
      <text>• NH₃-Cu²⁺：logβ ≈ 13.1（4个NH₃）</text>
      <text>• en-Ni²⁺：logβ ≈ 18.3（3个en）</text>
      <text>• CN⁻-Ag⁺：logβ ≈ 21.1（2个CN⁻）</text>
    </view>
  </view>
</view>

