<view class="solution-page">
  <!-- 页面头部 -->
  <view class="page-header">
    <text class="header-icon">⚗️</text>
    <view class="header-content">
      <view class="header-title">溶液配比计算</view>
      <view class="header-desc">计算溶液混合或稀释的浓度与体积</view>
    </view>
  </view>

  <!-- 计算模式选择 -->
  <view class="section-card">
    <view class="section-title">计算模式</view>
    <picker mode="selector" range="{{modeOptions}}" value="{{modeIndex}}" bindchange="handleModeChange">
      <view class="picker-display">
        <text>{{modeOptions[modeIndex]}}</text>
        <text class="picker-arrow">▼</text>
      </view>
    </picker>
  </view>

  <!-- 输入区域 -->
  <view class="section-card">
    <view class="section-title">输入参数</view>
    
    <!-- 溶液1 -->
    <view class="input-group">
      <view class="group-label">溶液 1</view>
      <calculator-input
        label="体积 (mL)"
        type="digit"
        value="{{v1}}"
        placeholder="例如：50"
        validator="positive"
        bindinput="handleV1Input"
      />
      <calculator-input
        label="浓度 (mol·L⁻¹)"
        type="digit"
        value="{{c1}}"
        placeholder="例如：0.5"
        validator="positive"
        bindinput="handleC1Input"
      />
    </view>

    <!-- 溶液2或目标值 -->
    <view class="input-group">
      <view class="group-label">{{modeIndex === 0 ? '溶液 2' : '目标'}}</view>
      <calculator-input
        label="{{modeIndex === 0 ? '体积 (mL)' : '目标体积 (mL)'}}"
        type="digit"
        value="{{v2}}"
        placeholder="{{modeIndex === 0 ? '例如：50' : '例如：100'}}"
        validator="positive"
        bindinput="handleV2Input"
      />
      <calculator-input
        label="{{modeIndex === 0 ? '浓度 (mol·L⁻¹)' : '目标浓度 (mol·L⁻¹)'}}"
        type="digit"
        value="{{c2}}"
        placeholder="{{modeIndex === 0 ? '例如：0.3' : '可选'}}"
        bindinput="handleC2Input"
      />
    </view>

    <!-- 计算按钮 -->
    <view class="action-buttons">
      <button class="btn-primary" bindtap="calculate">计算</button>
      <button class="btn-secondary" bindtap="reset">清空</button>
    </view>
  </view>

  <!-- 结果展示 -->
  <result-card
    wx:if="{{result}}"
    title="计算结果"
    result="{{resultText}}"
    hint="{{hint}}"
    show-copy="{{true}}"
    show-export="{{true}}"
    show-history="{{true}}"
    history-type="solution"
    history-input="{{historyInput}}"
    unit="{{unit}}"
    precision="{{precision}}"
    formula="{{formula}}"
    data-source="稀释定律 C₁V₁=C₂V₂"
    show-metadata="{{true}}"
    metadata-expanded="{{false}}"
  >
    <view class="result-display">
      <view class="result-main">{{result}}</view>
      <view class="result-formula" wx:if="{{formula}}">{{formula}}</view>
    </view>
  </result-card>

  <!-- 说明卡片 -->
  <view class="info-card">
    <view class="info-header">
      <text class="info-icon">📖</text>
      <text>公式说明</text>
    </view>
    <view class="info-content">
      <view class="formula-item">
        <text class="formula-label">溶液混合（同溶质）：</text>
        <text class="formula">c(混) = (c₁V₁ + c₂V₂) / (V₁ + V₂)</text>
      </view>
      <view class="formula-item">
        <text class="formula-label">溶液稀释：</text>
        <text class="formula">C₁V₁ = C₂V₂</text>
      </view>
    </view>
  </view>

  <!-- 提示卡片 -->
  <view class="tip-card">
    <view class="tip-header">
      <text class="tip-icon">💡</text>
      <text>使用提示</text>
    </view>
    <view class="tip-content">
      <text>• 溶液混合：计算两种同溶质溶液混合后的浓度</text>
      <text>• 溶液稀释：根据C₁V₁=C₂V₂计算稀释后的浓度</text>
      <text>• 体积单位：mL（毫升）</text>
      <text>• 浓度单位：mol·L⁻¹（摩尔每升）</text>
      <text>• 假设体积具有加和性（稀溶液近似）</text>
    </view>
  </view>
</view>

