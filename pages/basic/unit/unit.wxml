<view class="unit-page">
  <!-- 页面标题 -->
  <view class="page-header">
    <text class="header-icon">🔁</text>
    <view class="header-content">
      <view class="header-title">单位换算</view>
      <view class="header-desc">支持长度、质量、体积、温度等单位转换</view>
    </view>
  </view>

  <!-- 换算类型选择 -->
  <view class="section-card">
    <view class="section-title">换算类型</view>
    <picker mode="selector" range="{{categories}}" value="{{categoryIndex}}" bindchange="handleCategoryChange">
      <view class="picker-display">
        <text>{{categories[categoryIndex]}}</text>
        <text class="picker-arrow">▼</text>
      </view>
    </picker>
  </view>

  <!-- 输入区域 -->
  <view class="section-card">
    <view class="section-title">输入参数</view>
    
    <!-- 输入数值 -->
    <calculator-input
      label="数值"
      type="digit"
      value="{{inputValue}}"
      placeholder="请输入要换算的数值"
      validator="number"
      bindinput="handleValueInput"
      bindvalidate="handleValidate"
    />

    <!-- 原始单位 -->
    <view class="unit-selector">
      <view class="selector-label">原始单位</view>
      <picker mode="selector" range="{{units}}" value="{{fromUnitIndex}}" bindchange="handleFromUnitChange">
        <view class="unit-picker">
          <text>{{units[fromUnitIndex] || '请选择'}}</text>
          <text class="picker-arrow">▼</text>
        </view>
      </picker>
    </view>

    <!-- 交换按钮 -->
    <view class="swap-container">
      <button class="swap-btn" bindtap="swapUnits">
        <text class="swap-icon">⇄</text>
        <text>交换</text>
      </button>
    </view>

    <!-- 目标单位 -->
    <view class="unit-selector">
      <view class="selector-label">目标单位</view>
      <picker mode="selector" range="{{units}}" value="{{toUnitIndex}}" bindchange="handleToUnitChange">
        <view class="unit-picker">
          <text>{{units[toUnitIndex] || '请选择'}}</text>
          <text class="picker-arrow">▼</text>
        </view>
      </picker>
    </view>

    <!-- 计算按钮 -->
    <view class="action-buttons">
      <button class="btn-primary" bindtap="convert">开始换算</button>
      <button class="btn-secondary" bindtap="reset">清空</button>
    </view>
  </view>

  <!-- 结果展示 -->
  <result-card
    wx:if="{{result}}"
    title="换算结果"
    result="{{resultText}}"
    hint="{{hint}}"
    show-copy="{{true}}"
    show-export="{{true}}"
    show-history="{{true}}"
    history-type="unit"
    history-input="{{historyInput}}"
    unit="{{unit}}"
    precision="{{precision}}"
    formula="{{formula}}"
    data-source="标准换算系数"
    show-metadata="{{true}}"
    metadata-expanded="{{false}}"
  >
    <view class="result-display">
      <view class="result-value">{{result}}</view>
      <view class="result-formula" wx:if="{{formula}}">{{formula}}</view>
    </view>
  </result-card>

  <!-- 提示卡片 -->
  <view class="tip-card">
    <view class="tip-header">
      <text class="tip-icon">💡</text>
      <text>使用提示</text>
    </view>
    <view class="tip-content">
      <text>• 温度换算使用专用公式（℃ ⇄ ℉ ⇄ K）</text>
      <text>• 其他单位采用倍率直接换算</text>
      <text>• 支持科学计数法输入（如 1e-6）</text>
    </view>
  </view>
</view>

