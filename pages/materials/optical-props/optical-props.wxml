<view class="container">
  <!-- å·¥å…·é€‰æ‹© Tab -->
  <view class="tool-tabs">
    <view 
      wx:for="{{tools}}" 
      wx:key="id"
      class="tab-item {{currentTool === item.id ? 'active' : ''}}"
      data-tool="{{item.id}}"
      bindtap="switchTool"
    >
      <text class="tab-icon">{{item.icon}}</text>
      <text class="tab-name">{{item.name}}</text>
    </view>
  </view>

  <!-- é¢œè‰²ç©ºé—´è½¬æ¢ -->
  <view wx:if="{{currentTool === 'color-convert'}}" class="tool-content">
    <view class="tool-intro">
      <text class="intro-title">ğŸ¨ é¢œè‰²ç©ºé—´è½¬æ¢</text>
      <text class="intro-desc">RGBä¸HSVäº’ç›¸è½¬æ¢</text>
    </view>

    <view class="input-section">
      <view class="picker-field">
        <text class="picker-label">è½¬æ¢æ¨¡å¼</text>
        <picker mode="selector" range="{{conversionModes}}" value="{{conversionIndex}}" bindchange="handleConversionModeChange">
          <view class="picker-value">{{conversionModes[conversionIndex]}}</view>
        </picker>
      </view>

      <view wx:if="{{conversionIndex === 0}}">
        <text class="section-title">RGBè¾“å…¥ (0-255)</text>
        <view class="color-inputs">
          <calculator-input
            label="R (çº¢)"
            value="{{rgb_r}}"
            type="number"
            placeholder="0-255"
            icon="ğŸ”´"
            enableHistory="{{true}}"
            historyTool="optical"
            historyField="rgb"
            touchArea="large"
            bind:input="handleRgbRInput"
          />
          <calculator-input
            label="G (ç»¿)"
            value="{{rgb_g}}"
            type="number"
            placeholder="0-255"
            icon="ğŸŸ¢"
            bind:input="handleRgbGInput"
          />
          <calculator-input
            label="B (è“)"
            value="{{rgb_b}}"
            type="number"
            placeholder="0-255"
            icon="ğŸ”µ"
            bind:input="handleRgbBInput"
          />
        </view>
      </view>

      <view wx:else>
        <text class="section-title">HSVè¾“å…¥</text>
        <calculator-input
          label="H (è‰²ç›¸)"
          value="{{hsv_h}}"
          type="digit"
          placeholder="0-360"
          unit="Â°"
          icon="ğŸŒˆ"
          bind:input="handleHsvHInput"
        />
        <calculator-input
          label="S (é¥±å’Œåº¦)"
          value="{{hsv_s}}"
          type="digit"
          placeholder="0-100"
          unit="%"
          icon="ğŸ“Š"
          bind:input="handleHsvSInput"
        />
        <calculator-input
          label="V (æ˜åº¦)"
          value="{{hsv_v}}"
          type="digit"
          placeholder="0-100"
          unit="%"
          icon="ğŸ’¡"
          bind:input="handleHsvVInput"
        />
      </view>
    </view>

    <view class="button-group">
      <button class="calc-button primary" bindtap="convertColor">è½¬æ¢</button>
      <button class="calc-button" bindtap="clearResult">æ¸…ç©º</button>
    </view>

    <result-card wx:if="{{colorResultText}}" title="è½¬æ¢ç»“æœ">
      <view class="result-text">{{colorResultText}}</view>
    </result-card>
  </view>

  <!-- è§å…‰é‡å­äº§ç‡ -->
  <view wx:if="{{currentTool === 'quantum-yield'}}" class="tool-content">
    <view class="tool-intro">
      <text class="intro-title">ğŸ’¡ è§å…‰é‡å­äº§ç‡</text>
      <text class="intro-desc">ç›¸å¯¹æ³•è®¡ç®—</text>
      <text class="intro-formula">Î¦s = Î¦r Ã— (As/Ar) Ã— (Is/Ir) Ã— (Î·s/Î·r)Â²</text>
    </view>

    <view class="input-section">
      <text class="section-title">æ ·å“æ•°æ®</text>
      
      <calculator-input
        label="å¸å…‰åº¦"
        value="{{sampleAbs}}"
        type="digit"
        placeholder="ä¾‹å¦‚ï¼š0.05"
        icon="ğŸ“Š"
        hint="å»ºè®®<0.1"
        bind:input="handleSampleAbsInput"
      />

      <calculator-input
        label="è§å…‰å¼ºåº¦"
        value="{{sampleIntensity}}"
        type="digit"
        placeholder="ä¾‹å¦‚ï¼š5000"
        icon="ğŸ’¡"
        hint="ç§¯åˆ†å¼ºåº¦"
        bind:input="handleSampleIntensityInput"
      />

      <calculator-input
        label="æº¶å‰‚æŠ˜å°„ç‡"
        value="{{sampleRI}}"
        type="digit"
        placeholder="1.33"
        icon="ğŸ”"
        hint="æ°´ï¼š1.33ï¼Œä¹™é†‡ï¼š1.36"
        bind:input="handleSampleRIInput"
      />

      <view class="divider"></view>

      <text class="section-title">å‚ç…§ç‰©æ•°æ®</text>

      <view class="picker-field">
        <text class="picker-label">æ ‡å‡†å‚ç…§ç‰©</text>
        <picker mode="selector" range="{{fluorStandards}}" value="{{standardIndex}}" bindchange="handleStandardChange">
          <view class="picker-value">{{fluorStandards[standardIndex]}}</view>
        </picker>
      </view>

      <calculator-input
        label="å¸å…‰åº¦"
        value="{{refAbs}}"
        type="digit"
        placeholder="ä¾‹å¦‚ï¼š0.05"
        icon="ğŸ“Š"
        bind:input="handleRefAbsInput"
      />

      <calculator-input
        label="è§å…‰å¼ºåº¦"
        value="{{refIntensity}}"
        type="digit"
        placeholder="ä¾‹å¦‚ï¼š6000"
        icon="ğŸ’¡"
        bind:input="handleRefIntensityInput"
      />

      <calculator-input
        label="æŠ˜å°„ç‡"
        value="{{refRI}}"
        type="digit"
        placeholder="1.33"
        icon="ğŸ”"
        hint="è‡ªåŠ¨å¡«å……"
        bind:input="handleRefRIInput"
      />

      <calculator-input
        label="é‡å­äº§ç‡Î¦r"
        value="{{refQY}}"
        type="digit"
        placeholder="0.546"
        icon="â­"
        hint="è‡ªåŠ¨å¡«å……"
        bind:input="handleRefQYInput"
      />
    </view>

    <view class="button-group">
      <button class="calc-button primary" bindtap="calculateQY">è®¡ç®—</button>
      <button class="calc-button" bindtap="clearResult">æ¸…ç©º</button>
    </view>

    <result-card wx:if="{{qyResultText}}" title="è®¡ç®—ç»“æœ">
      <view class="result-text">{{qyResultText}}</view>
    </result-card>
  </view>

  <!-- å¯¼å‡ºæŒ‰é’® -->
  <view wx:if="{{colorResultText || qyResultText}}" class="export-button" bindtap="exportResult">
    <text>ğŸ“¤ å¯¼å‡ºç»“æœ</text>
  </view>
</view>

