<view class="periodic-page">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="page-header">
    <text class="header-icon">ğŸ§®</text>
    <view class="header-content">
      <view class="header-title">å…ƒç´ å‘¨æœŸè¡¨</view>
      <view class="header-desc">æŸ¥è¯¢å…ƒç´ åŸºæœ¬æ€§è´¨ä¸ç‰©ç†åŒ–å­¦å‚æ•°</view>
    </view>
  </view>

  <!-- å­¦æœ¯é£æ ¼æœç´¢ -->
  <view class="section-card">
    <search-input
      value="{{searchKeyword}}"
      placeholder="æœç´¢å…ƒç´ åç§°ã€ç¬¦å·æˆ–åŸå­åºæ•°"
      enableHistory="{{true}}"
      historyKey="periodic"
      hotSearches="{{hotElements}}"
      showHot="{{!searchKeyword}}"
      bindinput="handleSearchInput"
      bindsearch="handleSearch"
      bindclear="clearSearch"
    />

    <!-- å­¦æœ¯é£æ ¼ç­›é€‰å™¨ -->
    <quick-filter
      title="å…ƒç´ ç±»åˆ«"
      filters="{{categoryFilters}}"
      selected="{{selectedCategory}}"
      mode="single"
      showCount="{{true}}"
      bindchange="handleCategoryChange"
    />
  </view>

  <!-- éª¨æ¶å± -->
  <skeleton wx:if="{{loading}}" type="tool" rows="12"></skeleton>

  <!-- å…ƒç´ ç½‘æ ¼ -->
  <view wx:else class="section-card">
    <view class="section-title">
      <text>å…ƒç´ å‘¨æœŸè¡¨ ({{filteredElements.length}})</text>
      <text class="hint-text">ç‚¹å‡»å…ƒç´ æŸ¥çœ‹è¯¦æƒ…</text>
    </view>
    
    <view class="element-grid">
      <view 
        wx:for="{{filteredElements}}" 
        wx:key="number"
        class="element-card {{item.category}}"
        data-element="{{item}}"
        bindtap="showElementDetail"
      >
        <view class="card-number">{{item.number}}</view>
        <view class="card-symbol">{{item.symbol}}</view>
        <view class="card-name">{{item.name}}</view>
      </view>
      
      <view wx:if="{{filteredElements.length === 0}}" class="empty-hint">
        æœªæ‰¾åˆ°åŒ¹é…çš„å…ƒç´ 
      </view>
    </view>
  </view>

  <!-- å…ƒç´ è¯¦æƒ…å¼¹çª— -->
  <view wx:if="{{selectedElement}}" class="modal-overlay" bindtap="closeDetail">
    <view class="modal-content {{selectedElement.category}}-theme" catchtap="preventClose">
      <view class="modal-header">
        <view class="element-preview">
          <view class="preview-number">{{selectedElement.number}}</view>
          <view class="preview-symbol">{{selectedElement.symbol}}</view>
          <view class="preview-name">{{selectedElement.name}}</view>
        </view>
        <button class="close-btn" bindtap="closeDetail">Ã—</button>
      </view>

      <scroll-view class="modal-body" scroll-y="{{true}}">
        <view class="detail-section">
          <view class="detail-title">åŸºæœ¬ä¿¡æ¯</view>
          <view class="detail-grid">
            <view class="detail-item">
              <text class="item-label">åŸå­åºæ•°</text>
              <text class="item-value">{{selectedElement.number}}</text>
            </view>
            <view class="detail-item">
              <text class="item-label">å…ƒç´ ç¬¦å·</text>
              <text class="item-value">{{selectedElement.symbol}}</text>
            </view>
            <view class="detail-item">
              <text class="item-label">å…ƒç´ åç§°</text>
              <text class="item-value">{{selectedElement.name}}</text>
            </view>
            <view class="detail-item">
              <text class="item-label">ç›¸å¯¹åŸå­è´¨é‡</text>
              <text class="item-value">{{selectedElement.atomicMass}}</text>
            </view>
          </view>
        </view>

        <view class="detail-section">
          <view class="detail-title">ç‰©ç†æ€§è´¨</view>
          <view class="detail-grid">
            <view class="detail-item">
              <text class="item-label">çŠ¶æ€ï¼ˆå¸¸æ¸©ï¼‰</text>
              <text class="item-value">{{selectedElement.state || 'â€”'}}</text>
            </view>
            <view class="detail-item">
              <text class="item-label">ç†”ç‚¹ (K)</text>
              <text class="item-value">{{selectedElement.meltingPoint || 'â€”'}}</text>
            </view>
            <view class="detail-item">
              <text class="item-label">æ²¸ç‚¹ (K)</text>
              <text class="item-value">{{selectedElement.boilingPoint || 'â€”'}}</text>
            </view>
            <view class="detail-item">
              <text class="item-label">åŸå­åŠå¾„ (pm)</text>
              <text class="item-value">{{selectedElement.atomicRadius || 'â€”'}}</text>
            </view>
          </view>
        </view>

        <view class="detail-section">
          <view class="detail-title">åŒ–å­¦æ€§è´¨</view>
          <view class="detail-grid">
            <view class="detail-item">
              <text class="item-label">ç”µè´Ÿæ€§</text>
              <text class="item-value">{{selectedElement.electronegativity || 'â€”'}}</text>
            </view>
            <view class="detail-item">
              <text class="item-label">ç”µç¦»èƒ½ (kJ/mol)</text>
              <text class="item-value">{{selectedElement.ionizationEnergy || 'â€”'}}</text>
            </view>
            <view class="detail-item">
              <text class="item-label">å…ƒç´ ç±»åˆ«</text>
              <text class="item-value">{{categoryMap[selectedElement.category] || 'â€”'}}</text>
            </view>
            <view wx:if="{{selectedElement.electronAffinity !== undefined}}" class="detail-item">
              <text class="item-label">ç”µå­äº²å’Œèƒ½ (kJ/mol)</text>
              <text class="item-value">{{selectedElement.electronAffinity || 'â€”'}}</text>
            </view>
            <view wx:if="{{selectedElement.oxidationStatesText}}" class="detail-item full-width">
              <text class="item-label">æ°§åŒ–æ€</text>
              <text class="item-value">{{selectedElement.oxidationStatesText}}</text>
            </view>
          </view>
        </view>

        <!-- æ‰©å±•æ•°æ® - æ–°å¢éƒ¨åˆ† -->
        <view wx:if="{{selectedElement.hasExtendedData}}" class="detail-section extended-section">
          <view class="detail-title">
            <text>æ‰©å±•æ•°æ®</text>
            <view class="new-badge">NEW</view>
          </view>
          
          <view class="detail-grid">
            <view wx:if="{{selectedElement.density}}" class="detail-item">
              <text class="item-label">å¯†åº¦ (g/cmÂ³)</text>
              <text class="item-value">{{selectedElement.density}}</text>
            </view>
            <view wx:if="{{selectedElement.electronConfig}}" class="detail-item">
              <text class="item-label">ç”µå­æ„å‹</text>
              <text class="item-value">{{selectedElement.electronConfig}}</text>
            </view>
            <view wx:if="{{selectedElement.groupName}}" class="detail-item">
              <text class="item-label">æ—</text>
              <text class="item-value">{{selectedElement.groupName}}</text>
            </view>
            <view wx:if="{{selectedElement.periodName}}" class="detail-item">
              <text class="item-label">å‘¨æœŸ</text>
              <text class="item-value">{{selectedElement.periodName}}</text>
            </view>
            <view wx:if="{{selectedElement.blockName}}" class="detail-item">
              <text class="item-label">åŒºå—</text>
              <text class="item-value">{{selectedElement.blockName}}</text>
            </view>
            <view wx:if="{{selectedElement.valenceElectrons}}" class="detail-item">
              <text class="item-label">ä»·ç”µå­æ•°</text>
              <text class="item-value">{{selectedElement.valenceElectrons}}</text>
            </view>
            <view wx:if="{{selectedElement.crystalStructure}}" class="detail-item full-width">
              <text class="item-label">æ™¶ä½“ç»“æ„</text>
              <text class="item-value">{{selectedElement.crystalStructure}}</text>
            </view>
            <view wx:if="{{selectedElement.magneticOrdering}}" class="detail-item">
              <text class="item-label">ç£æ€§</text>
              <text class="item-value">{{selectedElement.magneticOrdering}}</text>
            </view>
            <view wx:if="{{selectedElement.thermalConductivity}}" class="detail-item">
              <text class="item-label">çƒ­å¯¼ç‡ W/(mÂ·K)</text>
              <text class="item-value">{{selectedElement.thermalConductivity}}</text>
            </view>
            <view wx:if="{{selectedElement.specificHeat}}" class="detail-item">
              <text class="item-label">æ¯”çƒ­å®¹ J/(molÂ·K)</text>
              <text class="item-value">{{selectedElement.specificHeat}}</text>
            </view>
          </view>
        </view>
      </scroll-view>

      <view class="modal-footer">
        <button class="btn-secondary" bindtap="copyElementInfo">å¤åˆ¶ä¿¡æ¯</button>
        <button class="btn-primary" bindtap="closeDetail">å…³é—­</button>
      </view>
    </view>
  </view>
</view>

