<!--pages/materials/organic-materials/organic-materials.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨æ ‡é¢˜ -->
  <view class="header">
    <text class="title">æœ‰æœºææ–™æ•°æ®åº“</text>
    <text class="subtitle">å¯¼ç”µèšåˆç‰© â€¢ æœ‰æœºåŠå¯¼ä½“ â€¢ MOFææ–™</text>
  </view>

  <!-- å­¦æœ¯é£æ ¼æœç´¢ -->
  <view class="search-section">
    <search-input
      value="{{searchKeyword}}"
      placeholder="æœç´¢æœ‰æœºææ–™åç§°ã€ç¼©å†™æˆ–åŒ–å­¦å¼"
      enableHistory="{{true}}"
      historyKey="organic-materials"
      hotSearches="{{hotMaterials}}"
      showHot="{{!searchKeyword}}"
      bindinput="onSearchInput"
      bindsearch="onSearch"
      bindclear="clearSearch"
    />
    
    <!-- å­¦æœ¯é£æ ¼åˆ†ç±»ç­›é€‰ -->
    <quick-filter
      title="ææ–™ç±»åˆ«"
      filters="{{categoryFilters}}"
      selected="{{selectedCategory}}"
      mode="single"
      showCount="{{false}}"
      bindchange="onCategoryFilterChange"
    />
  </view>

  <!-- ææ–™åˆ—è¡¨ -->
  <scroll-view class="material-list" scroll-y>
    <view 
      wx:for="{{displayMaterials}}" 
      wx:key="id"
      class="material-card"
      data-material="{{item}}"
      bindtap="showMaterialDetail"
    >
      <view class="material-header">
        <text class="material-name">{{item.name}}</text>
        <text class="material-abbr">{{item.abbreviation}}</text>
      </view>
      <view class="material-formula">{{item.formula}}</view>
      <view class="material-category">{{item.category}}</view>
      <view class="material-apps">
        <text wx:for="{{item.applications}}" wx:key="index" class="app-tag">{{item}}</text>
      </view>
    </view>
    
    <view wx:if="{{displayMaterials.length === 0}}" class="empty">
      <text>æš‚æ— æ•°æ®</text>
    </view>
  </scroll-view>

  <!-- è¯¦æƒ…å¼¹çª— - ä¼˜åŒ–ç‰ˆ -->
  <view wx:if="{{showDetail}}" class="detail-modal" bindtap="closeDetail">
    <view class="detail-content" catchtap="{{null}}">
      <!-- å¤´éƒ¨ -->
      <view class="detail-header">
        <view class="header-top">
          <text class="detail-title">{{selectedMaterial.name}}</text>
          <text class="detail-close" bindtap="closeDetail">âœ•</text>
        </view>
        <view class="header-info">
          <text class="header-abbr">{{selectedMaterial.abbreviation}}</text>
          <text class="header-category">{{selectedMaterial.category}}</text>
        </view>
      </view>
      
      <scroll-view class="detail-body" scroll-y="{{true}}" enable-flex="{{true}}">
        <!-- åŸºæœ¬ä¿¡æ¯å¡ç‰‡ -->
        <view class="info-card">
          <view class="card-title">
            <text class="title-icon">ğŸ“‹</text>
            <text class="title-text">åŸºæœ¬ä¿¡æ¯</text>
          </view>
          <view class="info-grid">
            <view class="info-item">
              <text class="info-label">è‹±æ–‡å</text>
              <text class="info-value">{{selectedMaterial.englishName}}</text>
            </view>
            <view class="info-item" data-text="{{selectedMaterial.formula}}" bindtap="copyInfo">
              <text class="info-label">åŒ–å­¦å¼</text>
              <text class="info-value formula">{{selectedMaterial.formula}}</text>
              <text class="copy-hint">ç‚¹å‡»å¤åˆ¶</text>
            </view>
            <view class="info-item">
              <text class="info-label">ææ–™ID</text>
              <text class="info-value">{{selectedMaterial.id}}</text>
            </view>
          </view>
        </view>

        <!-- æ€§èƒ½å‚æ•°å¡ç‰‡ -->
        <view class="info-card">
          <view class="card-title">
            <text class="title-icon">âš¡</text>
            <text class="title-text">æ€§èƒ½å‚æ•°</text>
          </view>
          <view class="performance-grid">
            <view wx:if="{{selectedMaterial.conductivity}}" class="perf-item">
              <text class="perf-label">ç”µå¯¼ç‡</text>
              <text class="perf-value">{{selectedMaterial.conductivity}}</text>
            </view>
            <view wx:if="{{selectedMaterial.bandgap}}" class="perf-item">
              <text class="perf-label">å¸¦éš™</text>
              <text class="perf-value">{{selectedMaterial.bandgap}} eV</text>
            </view>
            <view wx:if="{{selectedMaterial.mobility}}" class="perf-item">
              <text class="perf-label">è¿ç§»ç‡</text>
              <text class="perf-value">{{selectedMaterial.mobility}}</text>
            </view>
            <view wx:if="{{selectedMaterial.HOMO}}" class="perf-item">
              <text class="perf-label">HOMO</text>
              <text class="perf-value">{{selectedMaterial.HOMO}}</text>
            </view>
            <view wx:if="{{selectedMaterial.LUMO}}" class="perf-item">
              <text class="perf-label">LUMO</text>
              <text class="perf-value">{{selectedMaterial.LUMO}}</text>
            </view>
            <view wx:if="{{selectedMaterial.quantumYield}}" class="perf-item">
              <text class="perf-label">é‡å­æ•ˆç‡</text>
              <text class="perf-value">{{selectedMaterial.quantumYield}}</text>
            </view>
            <view wx:if="{{selectedMaterial.emission}}" class="perf-item">
              <text class="perf-label">å‘å°„æ³¢é•¿</text>
              <text class="perf-value">{{selectedMaterial.emission}}</text>
            </view>
            <view wx:if="{{selectedMaterial.seebeckCoeff}}" class="perf-item">
              <text class="perf-label">å¡è´å…‹ç³»æ•°</text>
              <text class="perf-value">{{selectedMaterial.seebeckCoeff}}</text>
            </view>
            <view wx:if="{{selectedMaterial.surfaceArea}}" class="perf-item">
              <text class="perf-label">æ¯”è¡¨é¢ç§¯</text>
              <text class="perf-value">{{selectedMaterial.surfaceArea}}</text>
            </view>
            <view wx:if="{{selectedMaterial.poreSize}}" class="perf-item">
              <text class="perf-label">å­”å¾„</text>
              <text class="perf-value">{{selectedMaterial.poreSize}}</text>
            </view>
          </view>
        </view>

        <!-- åº”ç”¨é¢†åŸŸå¡ç‰‡ -->
        <view class="info-card">
          <view class="card-title">
            <text class="title-icon">ğŸ¯</text>
            <text class="title-text">åº”ç”¨é¢†åŸŸ</text>
          </view>
          <view class="app-grid">
            <view wx:for="{{selectedMaterial.applications}}" wx:key="index" class="app-chip">
              <text class="app-dot">â€¢</text>
              <text class="app-text">{{item}}</text>
            </view>
          </view>
        </view>

        <!-- ææ–™ç‰¹æ€§å¡ç‰‡ -->
        <view class="info-card">
          <view class="card-title">
            <text class="title-icon">âœ¨</text>
            <text class="title-text">ææ–™ç‰¹æ€§</text>
          </view>
          <view class="properties-list">
            <view wx:for="{{selectedMaterial.properties}}" wx:for-item="value" wx:for-index="key" wx:key="key" class="prop-row">
              <view class="prop-left">
                <text class="prop-dot"></text>
                <text class="prop-key">{{key}}</text>
              </view>
              <text class="prop-value">{{value}}</text>
            </view>
          </view>
        </view>

        <!-- æ“ä½œæŒ‰é’® -->
        <view class="action-buttons">
          <button class="action-btn" data-text="{{selectedMaterial.name}}\n{{selectedMaterial.englishName}}\n{{selectedMaterial.formula}}\nç±»åˆ«ï¼š{{selectedMaterial.category}}" bindtap="copyInfo">
            <text class="btn-icon">ğŸ“‹</text>
            <text class="btn-text">å¤åˆ¶å…¨éƒ¨ä¿¡æ¯</text>
          </button>
        </view>
      </scroll-view>
    </view>
  </view>
</view>

